<div class="global_wrapper">
  <div class="foreground_element">
<h1><%= @recipe.name %></h1>
  <% @categories.each do |cat| %>
    |<%= cat.category.name %>|
  <% end %>
</div>

<% if @recipe[:photo] %>
<div class="foreground_element">
  <%= cl_image_tag @recipe.photo, height: 300, width: 400, crop: :fill %>
</div>
<% end %>

<div class="foreground_element">
<p><span class="section_title">Servings:</span> <%= @recipe.servings %></p>

<p><span class="section_title">Cooking time:</span> <%= @recipe.cooking_time %> mins</p>

<% if @equipments.exists? %>
<p><span class="section_title">Requires:</span>
  <% @equipments.each do |eq| %>
      <%= eq.equipment.name %>,
  <% end %>
</p>
<% end %>
</div>

<div class="foreground_element">
<h3>Ingredients</h3>
<ul>
<%= render 'shared/amounts' %>
</ul>
</div>

<div class="foreground_element">
<h3>Method</h3>
  <p><%= simple_format(@recipe.method) %></p>
</div>

<%= link_to profile_path(@recipe.user.profile) do %>
<div class="foreground_element">
<p>See all recipes by <%= @recipe.user.username %> </p>
</div>
<% end %>

<div class="foreground_element">
<h3>Comments</h3>
<% if current_user %>
  <%= simple_form_for [@recipe, @comment] do |f| %>
    <%= f.input :body, as: :text, label: 'Add a comment', input_html: { style: 'height: 150px' } %>
    <%= f.submit 'Comment', class: 'btn btn-primary' %>
  <% end %>
<% else %>
  <%= link_to 'Sign-in to comment', new_user_session_path %>
<% end %>
</div>

<% comments = Comment.where(recipe_id: params[:id]) %>
<% comments.each do |c| %>
  <div class="foreground_element">
    <p class="comment_body">
      <span class="comment_date"><%= c.created_at.strftime("%Y-%m-%d") %></span>
      <%= c.body %>
    </p>
    <p class="comment_user"><%= link_to c.user.username, profile_path(c.user) %></p>
  </div>
<% end %>
</div>
